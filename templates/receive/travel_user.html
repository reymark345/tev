<div id="loading-screen">
    <center>
        <div class="col">
            <!-- Fold -->
            <div class="sk-fold sk-primary">
              <div class="sk-fold-cube"></div>
              <div class="sk-fold-cube"></div>
              <div class="sk-fold-cube"></div>
              <div class="sk-fold-cube"></div>
            </div>
          </div>  
    </center>
</div>
{% extends 'index.html' %} {% block content %} {% load staticfiles %}

<link rel="stylesheet" href="{% static 'custom/custom.css' %}" />
<!-- Content wrapper -->
<div class="content-wrapper">
    <!-- Content -->
    <div class="container-fluid flex-grow-1 container-p-y">
        <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Received /</span> Travel</h4>

        <!-- DataTable with Buttons -->
        <div class="card">
            <div class="card-datatable table-responsive pt-0">
                <table id="tbl-items" class="table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="check-all" class="dt-checkboxes form-check-input"></th>
                            <th>Province</th>
                            <th>Municipality</th>
                            <th>Date Travel</th>
                            <th>Means of Transpo</th>
                            <th>Transportation</th>
                            <th>Per diem</th>
                            <th>Others</th>
                            <th>Total Amount</th>
                            <th>ID</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>




<!-- Edit User Modal -->
<div class="modal fade" id="advance-filter" tabindex="-1" aria-hidden="true">
<div class="modal-dialog modal-lg modal-simple modal-edit-user">
    <div class="modal-content p-3 p-md-5">
    <div class="modal-body">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="text-center mb-4">
        <h3 class="mb-2">Advanced Filter </h3>
        <p class="text-muted">Filter data by filling the details below</p>
        </div>
        <form id="advanced-filter-list" class="row g-3" onsubmit="return false">
            <div class="col-12 col-md-12">
                <label class="form-label" for="modalFEmployeeName">Employee Name</label>
                    <select id="f-employee-name" class="select2 form-select" name="FEmployeeName" multiple>
                        <option></option>
                    </select>
            </div>
            <div class="col-12 col-md-6">
                <label class="form-label" for="modalEditUserFirstName">ID Number</label>
                <input
                type="text"
                id="f-id-number"
                name="FIdNumber"
                class="form-control"
                placeholder="16-0000"
                />
            </div>
            <div class="col-12 col-md-6">
                <label class="form-label" for="modalEditUserLastName">Transaction Code</label>
                <input
                type="text"
                id="f-transaction-code"
                name="FTransactionCode"
                class="form-control"
                placeholder="23-00-00000"
                />
            </div>

            <div class="col-12 col-md-6">
                <label class="form-label" for="modalEditTaxID">Date Travel</label>
                <input type="text" class="form-control" name="FDateTravel" placeholder="DD-MM-YYYY" id="f-dateField" autocomplete="off"/>
            </div>


            <div class="col-12 col-md-6">
                <label class="form-label" >Incoming In</label>
                <input
                type="date"
                id="f-incoming-in"
                name="FIncomingIn"
                class="form-control"
                />
            </div>

            <div class="col-12 col-md-6">
                <label class="form-label">Original Amount</label>
                <div class="input-group">
                <span class="input-group-text">₱</span>
                <input
                    type="number"
                    id="f-original-amount"
                    name="FOriginalAmount"
                    class="form-control phone-number-mask"
                    placeholder="0.00"
                />
                </div>
            </div>

            <div class="col-12 col-md-6">
                <label class="form-label">Final Amount</label>
                <div class="input-group">
                <span class="input-group-text">₱</span>
                <input
                    type="number"
                    id="f-final-amount"
                    name="FFinalAmount"
                    class="form-control phone-number-mask"
                    placeholder="0.00"
                />
                </div>
            </div>

            <div class="col-12 col-md-6">
                <label class="form-label" for="modalAccountNumber">Account number</label>
                <input
                type="text"
                id="f-account-number"
                name="FAccountNumber"
                class="form-control"
                placeholder="23-00-00000"
                />
            </div>

            <div class="col-12 col-md-6">
                <label class="form-label" for="modalFEmployeeName">Status</label>
                <select
                id="f-status"
                name="FStatus"
                class="form-select"
                >
                    <option></option>
                    <option value="1">Pending</option>
                    <option value="3">Returned</option>
                </select>
            </div>
            <div class="col-12 col-md-12">
                <label class="form-label" for="modalFEmployeeName">Created By</label>
                <select class="select2 form-select" name="FCreatedBy" id="f-createdby">
                    <option></option>
                    {% for row in created_by %}
                    <option value="{{ row.id }}">{{ row.full_name }}</option>
                    {% endfor %}
                </select>
            </div>
                <input
                type="hidden"
                id="f-first-name"
                name="FFirstName"
                class="form-control"
                placeholder="Firstname"
                />

                <input
                type="hidden"
                id="f-middle-name"
                name="FMiddleName"
                class="form-control"
                placeholder="Middle"
                />

                <input
                type="hidden"
                id="f-last-name"
                name="FLastName"
                class="form-control"
                placeholder="Lastname"
                />

                <input
                type="hidden"
                id="f-adv-filter"
                name="FAdvancedFilter"
                class="form-control"
                placeholder="AdvFilter"
                />
        
           
            <div class="col-12 text-center">
                <br>
                <button type="button" id="search-advance-filter" class="btn btn-primary me-sm-3 me-1">Search</button>
                <button type="button" id="reset-advance-filter" class="btn btn-warning me-sm-3 me-1">Reset</button>
                <button type="button" id="clear-advance-filter" class="btn btn-label-secondary">Clear</button>
            
            </div>
        </form>
    </div>
    </div>
</div>
</div>
<!--/ Edit User Modal -->
<div class="modal fade" id="add-new-record" tabindex="-1" aria-hidden="true"></div>


<!-- Modal -->
<div class="modal fade" id="add-tev" tabindex="-1" aria-hidden="true">
    
<div class="modal-dialog modal-fullscreen" role="document">
    <div class="modal-content" style="background-color: #f8f7fa;">
        <div class="modal-header">
            
        
        </div>
    <div class="modal-body">
        <!-- Complex Headers -->

    <div style="display: flex; justify-content: space-between; width: 100%;">
        <div class="card" style="width:35%;">
            <br>
            {% comment %} <div class="alert alert-primary d-flex align-items-center" style="width: 90%; margin-left:20px;margin-right:20px;" role="alert">
                <span class="alert-icon text-primary me-2">
                    <i class="ti ti-info-circle ti-xs"></i>
                </span>
                TESTINGGG TESTINGGG TESTINGGG
            </div> {% endcomment %}
            <h5 class="card-header">TESTINGGG TESTINGGG TESTINGGG PROVINCEE PROVINCE </h5>
        </div>
        {% comment %} <div class="card" >
            <h5 class="card-header">TESTINGGG TESTINGGG TESTINGGG</h5>
        </div> {% endcomment %}
        <div class="card" style="width:20%;">
            <br>
            <div class="alert alert-primary d-flex align-items-center" style="width: 90%; margin-left:20px;margin-right:20px;" role="alert">
                <span class="alert-icon text-primary me-2">
                    <i class="ti ti-info-circle ti-xs"></i>
                </span>
                Total Amount : ₱ 50,000.00
              </div>
            {% comment %} <h5 class="card-header">Total Amount : ₱ 50,000.00</h5> {% endcomment %}
        </div>
    </div>
        
    <br><br>
    <!-- <div class="card" style="height: 90%;"> -->
        <div class="card">
            <h5 class="card-header">ITINERARY OF TRAVEL</h5>
            <div class="card-datatable text-nowrap">
                <table class="dt-complex-header table table-bordered" style="text-align: center;">
                    <thead style="background-color: #f5f5f6;">
                        <tr>
                            <th rowspan="2" width="2%" style="font-weight: bold;">
                                <a href="javascript:void(0);" id="addRowBtn" class="btn btn-primary btn-sm">
                                    <i class="fas fa-plus"></i>
                                </a>
                            </th>
                            <th rowspan="2" width="8%" style="font-weight: bold;">Date</th>
                            <th rowspan="2" width="12%" style="font-weight: bold;">Places to be visited (Destination)<br><br> From - To</th>
                            <th colspan="2" width="8%" style="font-weight: bold;">TIME</th>
                            <th rowspan="2" width="10%" style="font-weight: bold;">Means of Transportation</th>
                            <th rowspan="2" width="3%" style="font-weight: bold;">Transportation</th>
                            <th rowspan="2" width="3%" style="font-weight: bold;">Per Diem</th>
                            <th rowspan="2" width="3%" style="font-weight: bold;">Others</th>
                            <th rowspan="2" width="10%" style="font-weight: bold;">Total Amount</th>
                        </tr>
                        <tr>
                            <th>Departure</th>
                            <th>Arrival</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- First Row (Without Delete Icon) -->
                        <tr>
                            <td></td> <!-- No delete icon here -->
                            <td>
                                <input type="text" class="form-control" name="DateField" placeholder="DD-MM-YYYY" id="iot-date" autocomplete="off"/>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <select id="selectFrom" class="selectpicker w-100" data-style="btn-default" data-live-search="true">
                        
                                    </select>
                                    <span style="margin: 0 10px;"> - </span>
                                    <select id="selectTo" class="selectpicker w-100" data-style="btn-default" data-live-search="true">
                 
                                    </select>
                                </div>
                                <div class="d-flex align-items-center">
                                     <small><span><i>Specific Destination</i></span></small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                     <small><span><i>Specific Destination</i></span></small>
                                </div>
                                <div class="d-flex align-items-center">
                          
                                    <input type="text" class="form-control" placeholder="eg. Terminal" id="input-destination-from" >
                                    <span style="margin: 0 10px;"> - </span>
                                    <input type="text" class="form-control " placeholder="eg. Terminal" id="input-destination-to">
                                    </select>
                                </div>
                            </td>
                            <td><input type="text" class="form-control flatpickr-input active" placeholder="HH:MM" id="iot-departure" readonly="readonly"></td>
                            <td><input type="text" class="form-control flatpickr-input active" placeholder="HH:MM" id="iot-arrival" readonly="readonly"></td>
                            <td>Single Motor</td>
                            <td>120.00</td>
                            <td></td>
                            <td></td>
                            <td>120.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    <!-- <div class="card">
        <h5 class="card-header">ITINERARY OF TRAVEL</h5>
        <div class="card-datatable text-nowrap">
        <table class="dt-complex-header table table-bordered" style="text-align: center;">
            <thead style="background-color: #f5f5f6;">
            <tr>
                <th rowspan="2" width="2%" style="font-weight: bold;"><a href="javascript:void(0);" data-role="clear" data-id="01" data-content="2024-10-01" class="btn btn-primary btn-sm"><i class="fas fa-plus"></i></a></th>
                <th rowspan="2" width="8%" style="font-weight: bold;">Date</th>
                <th rowspan="2" width="12%" style="font-weight: bold;">Places to be visited (Destination)<br><br> From - To</th>
                <th colspan="2" width="8%" style="font-weight: bold;">TIME</th>
                <th rowspan="2" width="12%" style="font-weight: bold;">Means of Transportation</th>
                <th rowspan="2" width="3%" style="font-weight: bold;">Transportation</th>
                <th rowspan="2" width="3%" style="font-weight: bold;">Per Diem</th>
                <th rowspan="2" width="3%" style="font-weight: bold;">Others</th>
                <th rowspan="2" width="10%" style="font-weight: bold;">Total Amount</th>
            </tr>
            <tr>
                <th>Departure</th>
                <th>Arrival</th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td><a href="javascript:void(0);" data-role="clear" data-id="01" data-content="2024-10-01" class="btn btn-default btn-sm"><i class="fas fa-trash"></i></a></td>
                    <td>
                        <input type="text" class="form-control" name="DateField" placeholder="DD-MM-YYYY" id="iot-date" autocomplete="off"/>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">

                            <select
                                id="iot-from"
                                class="selectpicker w-100"
                                data-style="btn-default"
                                data-live-search="true"
                            >
                                <option data-tokens="0">Station</option>
                                <option data-tokens="1">Still in</option>
                                <option data-tokens="Jp Rizal">Jp Rizal</option>
                                <option data-tokens="Lemon">Lemon</option>
                            </select>
                              

                            <span style="margin: 0 10px;"> - </span>

                            <select
                                id="selectpickerLiveSearch"
                                class="selectpicker w-100"
                                data-style="btn-default"
                                data-live-search="true"
                            >
                                <option data-tokens="0">Station</option>
                                <option data-tokens="Jp Rizal">Jp Rizal</option>
                                <option data-tokens="Lemon">Lemon</option>
                            </select>

                        </div>
                    </td>
                    <td><input type="text" class="form-control flatpickr-input active"  placeholder="HH:MM" id="iot-departure" readonly="readonly"></td>
                    <td><input type="text" class="form-control flatpickr-input active"  placeholder="HH:MM" id="iot-arrival" readonly="readonly"></td>
                    <td>Single Motor</td>
                    <td>120.00</td>
                    <td></td>
                    <td></td>
                    <td>120.00</td>
                </tr>

                
                
               
            </tbody>
        </table>
        </div>
    </div> -->
    <!--/ Complex Headers -->
    

        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">
            Close
            </button>
            <button type="button" class="btn btn-primary">Save changes</button>
        </div>
        </div>
    </div>
</div>



{% endblock %} {% block footer_scripts %}

<script src="{% static 'assets/js/forms-pickers.js' %}"></script>
<script>
    let clicked_id = 0;
    let status_val =0;
    let formattedDates = ''
    let employeeList = [];
    let remarks_date = [];
    let selectedRemarks = [];
    let selectedCb = [];

    $(document).ready(function () {
        let rowCount = 1;

    // Initialize selectpicker for existing elements
    $('.selectpicker').selectpicker();

    // Add row functionality
    $('#addRowBtn').on('click', function() {
        // Increment rowCount to make IDs unique
        let rowId = rowCount++;

        // Define a template for the new row with unique IDs for each field
        let newRow = `
            <tr id="row${rowId}">
                <td><a href="javascript:void(0);" class="btn btn-default btn-sm deleteRowBtn"><i class="fas fa-trash"></i></a></td>
                <td><input type="text" class="form-control" id="dateField${rowId}" name="DateField" placeholder="DD-MM-YYYY" autocomplete="off"/></td>
                <td>
                    <div class="d-flex align-items-center">
                        <select id="selectFrom${rowId}" class="selectpicker w-100" data-style="btn-default" data-live-search="true">
            
                        </select>
                        <span style="margin: 0 10px;"> - </span>
                        <select id="selectTo${rowId}" class="selectpicker w-100" data-style="btn-default" data-live-search="true">
        
                        </select>
                    </div>
                    <div class="d-flex align-items-center">
                            <small><span><i>Specific Destination</i></span></small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <small><span><i>Specific Destination</i></span></small>
                    </div>
                    <div class="d-flex align-items-center">
                
                        <input type="text" class="form-control" placeholder="eg. Terminal" id="input-destination-from${rowId}" >
                        <span style="margin: 0 10px;"> - </span>
                        <input type="text" class="form-control " placeholder="eg. Terminal" id="input-destination-to${rowId}">
                        </select>
                    </div>
                </td>



                <td><input type="text" class="form-control flatpickr-input active" id="departure${rowId}" placeholder="HH:MM" readonly="readonly"></td>
                <td><input type="text" class="form-control flatpickr-input active" id="arrival${rowId}" placeholder="HH:MM" readonly="readonly"></td>
                <td>Single Motor</td>
                <td>120.00</td>
                <td></td>
                <td></td>
                <td>120.00</td>
            </tr>
        `;

        // Append the new row to the table body
        $('#tableBody').append(newRow);

        // Reinitialize selectpicker for the newly added elements
        $('.selectpicker').selectpicker('refresh');

        // Optionally, initialize Flatpickr for the new date and time fields
        $(`#dateField${rowId}`).flatpickr({
            dateFormat: "d-m-Y"
        });
        $(`#departure${rowId}`).flatpickr({
            enableTime: true,
            noCalendar: true,
            dateFormat: "H:i"
        });
        $(`#arrival${rowId}`).flatpickr({
            enableTime: true,
            noCalendar: true,
            dateFormat: "H:i"
        });
    });

    // Delete row functionality
    $(document).on('click', '.deleteRowBtn', function() {
        $(this).closest('tr').remove();
    });
            
        $('#f-employee-name').on('select2:open', function() {
            $('.select2-search__field').keydown(function(e) {
                if (e.keyCode === 9) { 
                var selectedValue = $('#f-employee-name').val();
                if (selectedValue) {
                    $('#f-employee-name').val(['2']).trigger('change.select2');
                }
                }
            });
        });

        var fdateField = $('#iot-date').flatpickr({
            allowInput: true,
            dateFormat: 'd-m-Y',
            locale: {
                'firstDayOfWeek': 1 // start week on Monday
            },
        });


        employeelist();
        psgc_api();
        $('#loading-screen').hide();
        var dateField = $('#dateField').flatpickr({
            mode: 'multiple',
            allowInput: true,
            dateFormat: 'd-m-Y',
            locale: {
                'firstDayOfWeek': 1 // start week on Monday
            },
        });
        var fdateField = $('#f-dateField').flatpickr({
            mode: 'multiple',
            allowInput: true,
            dateFormat: 'd-m-Y',
            locale: {
                'firstDayOfWeek': 1 // start week on Monday
            },
        });

        $('#fileInput').change(function() {
            var fileName = $(this).val().split('\\').pop(); // Get the selected file name
            $('#selectedFileName').text(fileName);
        });

        $("#dateField").on("change", function() {
            if(DateTravel.val()){
                $(".rangeTravel").prop("disabled", true);
            }
            else{
                $(".rangeTravel").prop("disabled", false);
            } 
          });

        $(".rangeTravel").on("change", function() {
          
            if(RangeTravel.val()){
                $("#dateField").prop("disabled", true);
            }
            else{
                $("#dateField").prop("disabled", false);
            } 
        });
       
        const table = $('#tbl-items')
        const ItemFormValidation = document.getElementById('item-form'),
            IotFrom = jQuery(document.querySelector('[name="IotFrom"]')),
            IotTo = jQuery(document.querySelector('[name="IotTo"]')),
            IotDeparture = document.querySelector('#iot-departure'),
            IotArrival = document.querySelector('#iot-arrival'),
            AdvancedFilter = document.getElementById('advanced-filter-list'),
            EmployeeName = jQuery(document.querySelector('[name="EmployeeName"]')),
            FEmployeeName = jQuery(document.querySelector('[name="FEmployeeName"]')),
            FIdNumber= jQuery(document.querySelector('[name="FIdNumber"]')),
            FTransactionCode= jQuery(document.querySelector('[name="FTransactionCode"]')),
            FDateTravel= jQuery(document.querySelector('[name="FDateTravel"]')),
            FIncomingIn= jQuery(document.querySelector('[name="FIncomingIn"]')),
            DateRemarks = jQuery(document.querySelector('[name="DateRemarks"]')),
            FOriginalAmount= jQuery(document.querySelector('[name="FOriginalAmount"]')),
            FFinalAmount= jQuery(document.querySelector('[name="FFinalAmount"]')),
            FAccountNumber= jQuery(document.querySelector('[name="FAccountNumber"]')),
            FStatus= jQuery(document.querySelector('[name="FStatus"]')),
            FCreatedBy= jQuery(document.querySelector('[name="FCreatedBy"]')),
            FFirstName= jQuery(document.querySelector('[name="FFirstName"]')),
            FMiddleName= jQuery(document.querySelector('[name="FMiddleName"]')),
            FLastName= jQuery(document.querySelector('[name="FLastName"]')),
            FAdvancedFilter= jQuery(document.querySelector('[name="FAdvancedFilter"]')),
            OriginalAmount = jQuery(document.querySelector('[name="OriginalAmount"]')),
            DateReceived = jQuery(document.querySelector('[name="DateReceived"]')),
            DateTravel = jQuery(document.querySelector('[name="DateTravel"]')),
            HDateTravel = jQuery(document.querySelector('[name="HDateTravel"]')),
            RangeTravel = jQuery(document.querySelector('[name="RangeTravel"]')),
            IdNumber = jQuery(document.querySelector('[name="IdNumber"]')),
            DivisionUser = jQuery(document.querySelector('[name="DivisionUser"]')),
            SectionUser = jQuery(document.querySelector('[name="SectionUser"]')),
            ContactNo = jQuery(document.querySelector('[name="ContactNo"]')),
            AccountNumber = jQuery(document.querySelector('[name="AccountNumber"]')),
            EmpName = jQuery(document.querySelector('[name="EmpName"]')),
            EmpMiddle = jQuery(document.querySelector('[name="EmpMiddle"]')),
            EmpLastname = jQuery(document.querySelector('[name="EmpLastname"]')),
            RemarksList= jQuery(document.querySelector('[name="RemarksList"]')),
            offCanvasElement = document.querySelector('#add-new-record'),
            search_advance_filter = $('#search-advance-filter'),
            reset_advance_filter = $('#reset-advance-filter'),
            clear_advance_filter = $('#clear-advance-filter')
        const offCanvasEl = new bootstrap.Offcanvas(offCanvasElement)
        const toast_options = (toastr.options = {
            maxOpened: 1,
            autoDismiss: true,
            closeButton: true,
            newestOnTop: true,
            progressBar: true,
            positionClass: 'toast-top-right',
            rtl: isRtl,
      });
        let ItemID = $('#item-id')

        let dataTable = table.DataTable({
            processing: true,
            serverSide: true,
            ajax: {
                url: "{% url 'travel-load' %}",
                data: function (d) {
                    d.FAdvancedFilter = FAdvancedFilter.val()
                    d.FIdNumber = FIdNumber.val()
                    d.FTransactionCode = FTransactionCode.val()
                    d.FDateTravel = FDateTravel.val()
                    d.FIncomingIn = FIncomingIn.val()
                    d.FOriginalAmount = FOriginalAmount.val()
                    d.FFinalAmount = FFinalAmount.val()
                    d.FAccountNumber = FAccountNumber.val()
                    d.FStatus = FStatus.val()
                    d.FCreatedBy = FCreatedBy.val()
                    d.FFirstName = FFirstName.val()
                    d.FMiddleName = FMiddleName.val()
                    d.FLastName = FLastName.val()
                    d.EmployeeList = employeeList
                },
            },
            columns: [
                {
                    data: 'id', status: 'status',
                    orderable: false, 
                    render: function (data, type, row) {
                        let isChecked = selectedCb.includes(data.toString());
                        var status = row.status;
                        var status = row.status;
                        if (status == 3) {
                            return '<input type="checkbox" disabled="disabled" class="dt-checkboxes form-check-input">';
                        } else {
                            return `<input type="checkbox" class="dt-checkboxes form-check-input checkbox-items" value="${data}" id ="checkbox_data" ${isChecked ? 'checked' : ''}>`;
                        }

                    }
                },
                { data: 'id_no' },
                { data: 'name' },
                { data: 'original_amount'},
                { data: 'final_amount'},
                { data: 'date_travel'},
                { data: 'status' },
                { data: 'incoming_in' },
                { data: 'slashed_out' },
                { data: 'id'},
            ],
            columnDefs: [
                {
                    targets: 1,
                    render: function(data) {
                        if (data){
                            return '<span class="badge bg-label-primary">' + data + '</span>';
                        }
                        else {
                            return ''
                        }
                    },
                },
                {
                  targets: -1,
                  title: 'Action',
                  orderable: false,
                  searchable: false,
                  render: function (data) {
                    return (
                        '<a href="javascript:;" data-id="' + data + '" class="item-edit text-body"><i class="text-primary ti ti-pencil"></i></a>' +
                        '<a href="javascript:;" data-id="' + data + '" class="item-delete text-body"><i class="text-primary ti ti-trash"></i></a>'
                    )
                  },
              },
            ],
            dom: '<"card-header flex-column flex-md-row"<"head-label text-center"><"dt-action-buttons text-end pt-3 pt-md-0"B>><"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6 d-flex justify-content-center justify-content-md-end"f>>t<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',
            buttons: [
                {
                    className: 'btn btn-label-primary me-2',
                    text: '<i class="ti ti-file-search me-sm-1"></i> <span class="d-none d-sm-inline-block">Advance Filter</span>',
                    action: function () {
                        employeeList = [];
                        const $selectElement = $('#f-employee-name');
                        $selectElement.empty();
                        fetchEmployee($selectElement);
                        FEmployeeName.val('').trigger('change');
                        setTimeout(function() {
                            if (FEmployeeName.length) {
                                FEmployeeName.wrap('<div class="position-relative"></div>')
                                FEmployeeName.select2({
                                    placeholder: 'Choose employee',
                                    dropdownParent: FEmployeeName.parent(),
                                    allowClear: true,
                                })
                            }
                        }, 300);
                        clear_advfilter();
                        $("#advance-filter").modal("show");
                    }
    
                },
                {
                    className: 'btn btn-primary',
                    text: '<i class="ti ti-file-export me-sm-1"></i> <span class="d-none d-sm-inline-block">Add New Record</span>',
                    action: function () {
                        employeeList = [];
                        

                        if (IotDeparture) {
                            IotDeparture.flatpickr({
                            enableTime: true,
                            noCalendar: true
                            });
                        }
                        if (IotArrival) {
                            IotArrival.flatpickr({
                            enableTime: true,
                            noCalendar: true
                            });
                        }
                        $("#add-tev").modal("show");

                    }
    
                },
            ],
            drawCallback: function (settings) {
            },
        })
        // $('div.head-label').html('<h5 class="card-title mb-0">Items</h5>')
        $('div.head-label').html('<h5 class="card-title mb-0 d-flex align-items-center">'+
        '<button type="submit" id="forward" class="btn btn-primary">Submit</button>' +
        '</h5>');

        const newRecord = document.querySelector('.create-new')
            if (newRecord) {
                newRecord.addEventListener('click', function () {
                    const $selectElement1 = $('#employee-name');
                    $selectElement1.empty();
                    fetchEmployee($selectElement1);
                    if (EmployeeName.length) {
                        EmployeeName.wrap('<div class="position-relative"></div>')
                        EmployeeName.select2({
                            placeholder: 'Choose employee',
                            dropdownParent: EmployeeName.parent(),
                            allowClear: true,
                        })
                    }

                    if (RemarksList.length) {
                        RemarksList.wrap('<div class="position-relative"></div>')
                        RemarksList.select2({
                        placeholder: 'Choose remarks',
                        dropdownParent: RemarksList.parent(),
                        allowClear: true,
                        })
                    }
                    ItemID.val(0);
                    $('.rows-container').empty();
                    $(".rangeTravel").prop("disabled", false);
                    OriginalAmount.prop("disabled", false);
                    $('.title-name').text('Add Travel Data');
                    status_val = 0;
                    EmployeeName.val('').trigger('change').prop("disabled", false);
                    $('.form-control').val('');
         
                    offCanvasEl.show()
                })
            }
        const fv = FormValidation.formValidation(ItemFormValidation, {
            fields: {
                EmployeeName: {
                    validators: {
                        notEmpty: {
                            message: 'Please Select Employee',
                        },
                    },
                },
                OriginalAmount: {
                    validators: {
                        notEmpty: {
                            message: 'Please Select Amount',
                        },
                    },
                },
                

            },
            plugins: {
                trigger: new FormValidation.plugins.Trigger(),
                bootstrap5: new FormValidation.plugins.Bootstrap5(),
                submitButton: new FormValidation.plugins.SubmitButton(),
                autoFocus: new FormValidation.plugins.AutoFocus(),
            },
            init: (instance) => {
                instance.on('plugins.message.placed', function (e) {
                    if (e.element.parentElement.classList.contains('input-group')) {
                        e.element.parentElement.insertAdjacentElement('afterend', e.messageElement)
                    }
                })
            },
        }).on('core.form.valid', function () {
            let selectedIDs = [];
            let selectedDate = [];
            if (DateTravel.val() && RangeTravel.val() ){
                toastr.error('Duplicate Travel Date : Select only one', 'Invalid', toast_options);
            }
            else if (!DateTravel.val() && !RangeTravel.val()){
                toastr.error('Please: Select one Date Travel', 'Invalid', toast_options);
            }
            else {
                let dateValues = [];
                let isValidationError = 0;
                $('.rows-container .row').each(function() {
                    let selectElement = $(this).find('.select-remarks');
                    let selectElementDate = $(this).find('.select-remarks');
                    let selectedValue = selectElement.val();
                    let selectErrorLabel = selectElement.siblings(".error-label");

                    let inputElement = $(this).find('.input-date');
                    let inputValue = inputElement.val();
                    let inputErrorLabel = inputElement.siblings(".error-label-date");

                    if (selectedValue !== "") {
                        selectedIDs.push(selectedValue);
                        selectElement.removeClass('has-error');
                        selectErrorLabel.hide();
                    } else {
                        isValidationError++;
                        selectElement.addClass('has-error');
                        selectErrorLabel.show();
                    }
                    if (inputValue !== "") {
                        selectedDate.push(inputValue);
                        inputElement.removeClass('has-error');
                        inputErrorLabel.hide();
                    } else {
                        isValidationError++;
                        inputElement.addClass('has-error');
                        inputErrorLabel.show();
                    }
                });
                if (isValidationError == 0) {
                    let amount = OriginalAmount.val();
                    let date_travel = DateTravel.val();
                    let range_travel = RangeTravel.val();
                    let id_no = IdNumber.val();
                    let acct_no = AccountNumber.val();
                    let name = EmpName.val();
                    let middle = EmpMiddle.val();
                    let lname = EmpLastname.val();
                    let hdate_travel = HDateTravel.val();
                    let division = DivisionUser.val();
                    let section = SectionUser.val();
                    let contact = ContactNo.val();
                    let date_received = DateReceived.val();
                    let post_url = (status_val == 3)? "{% url 'item-returned' %}": (ItemID.val() !== '0')? "{% url 'item-update' %}": "{% url 'item-add' %}";
                    let form_data = $('#item-form').serialize()
                    $.ajax({
                        type: 'POST',
                        url: post_url,
                        data: {
                            DateTravel: date_travel,
                            RangeTravel: range_travel,
                            AccountNumber: acct_no,
                            IdNumber: id_no,
                            EmpName: name,
                            EmpMiddle: middle,
                            EmpLastname: lname,
                            OriginalAmount: amount,
                            form_data: form_data,
                            dateValues: dateValues,
                            HDateTravel: hdate_travel,
                            Division: division,
                            Section: section,
                            Contact: contact,
                            ItemID:ItemID.val(),
                            selectedRemarks: selectedIDs,
                            selectedDate: selectedDate,
                            DateReceived: date_received
                        }
                    }).done(function (data) {                
                        function formatDate(dateString) {
                            const [day, month, year] = dateString.split("-");
                            const months = ["Jan.", "Feb.", "Mar.", "Apr.", "May", "Jun.", "Jul.", "Aug.", "Sep.", "Oct.", "Nov.", "Dec."];
                            const monthName = months[parseInt(month, 10) - 1];
                            return `${monthName} ${day}, ${year}`;
                        }
                        if (data.data == 'success') {
                            $('.rows-container').empty();
                            let code = data.g_code;
                            if (code){
                                toastr.success('Save Successfully', 'Success', toast_options);
                            }
                            else{
                                offCanvasEl.hide()
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Update Successfully!',
                                    html:
                                    'Successfully <b>Save!</b>',
                                    customClass: {
                                        confirmButton: 'btn btn-success',
                                    },
                                })
                            }
                            EmployeeName.val("").trigger('change');
                            RemarksList.val([]).trigger("change");
                            OriginalAmount.val("");
                            DateReceived.val("");
                            DateTravel.val("");
                            RangeTravel.val("");

                            dataTable.ajax.reload();
                        } else {
                            if (status_val== 0){
                                dateField.clear();
                                EmployeeName.val("").trigger('change');
                                RemarksList.val([]).trigger("change");
                                OriginalAmount.val("");
                                DateReceived.val("");
                                DateTravel.val("");
                                RangeTravel.val("");
                            }
                            let formattedDates = data.message.map(date => formatDate(date)).join(" | ");
                            dataTable.ajax.reload();
                            Swal.fire({
                                icon: 'error',
                                title: 'Duplicate Travel!',
                                html:"Date: <br><b>"+formattedDates+"</b>",
                                customClass: {
                                    confirmButton: 'btn btn-success',
                                },
                            })
                        }
                    })
                }
            }
        });



        
        // Form validation for Add new record
        const adv = FormValidation.formValidation(AdvancedFilter, {
            fields: {
            },
            plugins: {
                trigger: new FormValidation.plugins.Trigger(),
                bootstrap5: new FormValidation.plugins.Bootstrap5(),
                submitButton: new FormValidation.plugins.SubmitButton(),
                autoFocus: new FormValidation.plugins.AutoFocus(),
            },
            init: (instance) => {
                instance.on('plugins.message.placed', function (e) {
                    if (e.element.parentElement.classList.contains('input-group')) {
                        e.element.parentElement.insertAdjacentElement('afterend', e.messageElement)
                    }
                })
            },
        }).on('core.form.valid', function () {
            var form_data = $('#advanced-filter-list').serialize();
            var form_data = $('#item-form').serialize()
            $.ajax({
                type: 'POST',
                url: "{% url 'search-list' %}",
                data: form_data,
            }).done(function (data) {
                if (data.data == 'success') {

                } else {

                }
            });

        });


    function fetchEmployee($selectElement) {
        const employees = JSON.parse(localStorage.getItem('employees'));
        if (employees) {
            $.each(employees, function (index, employee) {
                const optionText = `${employee.firstName} ${employee.middleInitial} ${employee.lastName}`;
                const $option = $('<option>', {
                    value: employee.idNumber,
                    text: optionText,
                    id: employee.idNumber
                });
                $selectElement.append($option);
            });
        } else {
            console.log("No employee data found in local storage.");
        }
    }
 

    function employeelist(){
        $.ajax({
            type: 'GET',
            url: "{% url 'receive-api' %}",
            dataType: 'json',
        }).done(function (data) {
            let fields = data.data;
            let employees = [];
            $.each(fields, function (index, employee) {
                let firstName = employee.first_name;
                let middleName = employee.middle_name;
                let middleInitial = middleName.charAt(0);
                let lastName = employee.last_name;
                let idNumber = employee.id_number;
                let accNumber = employee.account_number;
                let division = employee.division;
                let position = employee.position;
                let gender = employee.gender;
                let section = employee.section;
                let image_path = employee.image_path;
                let contact = employee.contact;
        
                let employeeObj = {
                    firstName: firstName,
                    middleInitial: middleInitial,
                    lastName: lastName,
                    idNumber: idNumber,
                    accNumber: accNumber,
                    division: division,
                    position: position,
                    gender: gender,
                    section: section,
                    image: image_path,
                    contact_no: contact
                };
                employees.push(employeeObj);
            });
            localStorage.setItem('employees', JSON.stringify(employees));
        });
        
    }

    function psgc_api() {
        $.ajax({
            type: 'GET',
            url: "{% url 'psgc-api' %}",
            dataType: 'json',
        }).done(function (data) {
            console.log(data);
            console.log("testttt");
            if (data.error) {
                console.error(data.error);
                return;
            }

            let provinces = data;
            let psgc = [];

            $.each(provinces, function (index, province) {
                let provinceName = province.prov_name; 
                psgc.push({
                    id: province.prov_id,
                    name: provinceName,
                });
            });
           
        }).fail(function (jqXHR, textStatus, errorThrown) {
            console.error("AJAX request failed: " + textStatus + ", " + errorThrown);
        });
    }

    function incoming_out(){
        selectedCb = $.grep(selectedCb, function(value) {
            return value !== 'on';
        });

        Swal.fire({
            title: 'Forward?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, Forward it!',
            customClass: {
                confirmButton: 'btn btn-primary me-3',
                cancelButton: 'btn btn-label-secondary',
            },
            buttonsStyling: false,
        }).then(function (result) {
            if (result.value) {
                $.ajax({
                    type: 'POST',
                    url: "{% url 'out-pending-tev' %}",
                    data:{
                        out_list: selectedCb
                    }
                }).done(function (data) {
                    if (data.data == 'success') {
                        selectedCb = [];
                        Swal.fire({
                            icon: 'success',
                            title: 'Successfully save!',
                            text: 'Item has been added.',
                            customClass: {
                                confirmButton: 'btn btn-success',
                            },
                        })
                        dataTable.ajax.reload()
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error saving!',
                            text: data.message,
                            customClass: {
                                confirmButton: 'btn btn-success',
                            },
                        })
                    }
                })
            }
        })

    }
    $('#forward').on('click', function(){
        if(selectedCb.length ===0){
            toastr.error('Selected item first', 'Invalid', toast_options);
        }
        else{
            incoming_out();
        }
    });

    $('#add_remarks').click(function () {     
        var newRow = $('<div class="row mt-2">' +
            '<div class="col-5">' +
            '<select class="form-select select-remarks" id="select_remarks">' +
                '<option></option>'+
                '{% for row in remarks_list %}'+
                '<option value="{{ row.id }}">{{ row.name }}</option>'+
                '{% endfor %}'+
            '</select>' +
            '<span class="error-label">Required</span>'+
            '</div>' +
            '<div class="col-5">' +
            '<input type="date" id="date-remarks" name="DateRemarks" class="form-control input-date" value="" />'+
            '<span class="error-label-date">Required</span>'+
            '</div>' +
            '<div class="col-2">' +
            '<button type="button" class="btn btn-warning delete-row">-</button>' +
            '</div>' +
            '</div>');
            newRow.find('.error-label, .error-label-date').hide();
        $('.rows-container').append(newRow);
    });
    $('.container').on('click', '.delete-row', function () {
        $(this).closest('.row').remove();
    });
    $(document).on('click', '.delete-row', function () {
        $(this).closest('.row').remove();
    });

    $('.container').on('click', '.delete-row', function () {
            $(this).closest('.row').remove();
    });

    $('#uploadButton').on('click', function(event) {
        if ($('#fileInput').get(0).files.length === 0) {
            toastr.error('No Excel File Selected', 'Invalid', toast_options);
        } 
        else {
            $("#import-excel").modal("hide");
            $('#loading-screen').show();
            event.preventDefault();
            let LStorage = JSON.parse(localStorage.getItem('employees'));
            var formData = new FormData();
            formData.append('ExcelData', $('input[name=ExcelData]')[0].files[0]);
            formData.append('employees', JSON.stringify(LStorage));
            $.ajax({
                type: "POST",
                url: "{% url 'upload-tev' %}",
                data: formData,
                contentType: false,
                processData: false,
                }).done(function(data){
                if (data.data == 'success') {
                    $('#fileInput').val('');
                    $('#selectedFileName').text('');

                    $('#loading-screen').hide();

                    if (data.id_no && data.id_no.length){
                        Swal.fire({
                            title: '<strong>ID NUMBER NOT FOUND!</strong> <br><h5><u>'+data.id_no+'<h5></u>',
                            icon: 'error',
                            html:
                            'Excel <b>NOT SAVE!</b>',
                            showCloseButton: true,
                            showCancelButton: false,
                            focusConfirm: false,
                            confirmButtonText: '<i class="ti ti-thumb-up"></i> Done!',
                            confirmButtonAriaLabel: 'Thumbs up, great!',
                            customClass: {
                            confirmButton: 'btn btn-danger me-3'
                            },
                            buttonsStyling: false
                        });
                        toastr.error('Invalid', 'Error', toast_options);
                    }
                    else if (data.duplicate_excel_dates){
                        let duplicate = data.duplicate_excel_dates;
                        let tableRows = duplicate.map(item => {
                            return `<tr>
                                        <td style="border: 1px solid black;">${item.id_no}</td>
                                        <td style="border: 1px solid black;">${item.duplicate_travel}</td>
                                    </tr>`;
                        });

                        Swal.fire({
                            title: '<strong>Excel File Duplication Date!</strong>',
                            icon: 'error',
                            html:
                            'Excel <b>NOT SAVE!</b> Please <b>reupload</b> the file!' +
                            '<table style="width:100%;">' +
                            '<tr>' +
                            '<th style="border: 1px solid black;"><b>ID number</b></th>' +
                            '<th style="border: 1px solid black;"><b>Duplicate date</b> <small>(dd-mm-yyyy)</small></th>' +
                            '</tr>' +
                            `${tableRows.join('')}` + // Join the rows and insert them into the table
                            '</table>',
                            showCloseButton: true,
                            showCancelButton: false,
                            focusConfirm: false,
                            allowOutsideClick: false,
                            confirmButtonText: '<i class="ti ti-thumb-up"></i> Done!',
                            confirmButtonAriaLabel: 'Thumbs up, great!',
                            customClass: {
                            confirmButton: 'btn btn-danger me-3'
                            },
                            buttonsStyling: false
                        });
                        toastr.error('Invalid', 'Error', toast_options);

                    }
                    else if(data.duplicate_travel){
                        let duplicate = data.duplicate_travel;
                        let tableRows = duplicate.map(item => {
                            return `<tr>
                                        <td style="border: 1px solid black;">${item.id_no}</td>
                                        <td style="border: 1px solid black;">${item.duplicate_travel}</td>
                                    </tr>`;
                        });

                        Swal.fire({
                            title: '<strong>Duplicate TRAVEL, Added already in System!</strong>',
                            icon: 'error',
                            html:
                            'Excel <b>NOT SAVE!</b> Please <b>reupload</b> the file!' +
                            '<table style="width:100%;">' +
                            '<tr>' +
                            '<th style="border: 1px solid black;"><b>ID number</b></th>' +
                            '<th style="border: 1px solid black;"><b>Duplicate date</b> <small>(dd-mm-yyyy)</small></th>' +
                            '</tr>' +
                            `${tableRows.join('')}` + // Join the rows and insert them into the table
                            '</table>',
                            showCloseButton: true,
                            showCancelButton: false,
                            focusConfirm: false,
                            allowOutsideClick: false,
                            confirmButtonText: '<i class="ti ti-thumb-up"></i> Done!',
                            confirmButtonAriaLabel: 'Thumbs up, great!',
                            customClass: {
                            confirmButton: 'btn btn-danger me-3'
                            },
                            buttonsStyling: false
                        });
                        toastr.error('Invalid', 'Error', toast_options);
                        

                    }
                    else{
                        toastr.success('Successfully save', 'Success', toast_options);
                    }

                    $("#import-excel").modal("hide");
                    dataTable.ajax.reload();

                } 
                else if (data.data == 'empty'){
                    $("#import-excel").modal("hide");
                    $('#loading-screen').hide();
                    Swal.fire({
                            title: '<strong>Excel File: Empty column!</strong>',
                            icon: 'error',
                            html:
                            'Excel <b>NOT SAVE! Please Review and Reupload</b> the file!',
                            showCloseButton: true,
                            showCancelButton: false,
                            focusConfirm: false,
                            confirmButtonText: '<i class="ti ti-thumb-up"></i> Done!',
                            confirmButtonAriaLabel: 'Thumbs up, great!',
                            customClass: {
                            confirmButton: 'btn btn-danger me-3'
                            },
                            buttonsStyling: false
                        });
                    toastr.error('Invalid', 'Error', toast_options);
                    
                }
                else {
                    toastr.error('Data not saved Please Contact Administrator', 'Danger', toast_options);
                }
        });

        }

    });

    search_advance_filter.on('click', function () {
        FAdvancedFilter.val("true");
        $('#f-employee-name').empty();
        $("#advance-filter").modal("hide");
        dataTable.ajax.reload();
        toastr.success('Search successfully', 'Success', toast_options);
    });

    reset_advance_filter.on('click', function () {
        FAdvancedFilter.val('');
        $('#f-employee-name').empty();
        $("#advance-filter").modal("hide");
        dataTable.ajax.reload();
        toastr.success('Data has been reset', 'Success', toast_options);
    });

    clear_advance_filter.on('click', function () {
        clear_advfilter();
        toastr.success('Clear successfully', 'Success', toast_options);
    });

    function clear_advfilter(){
        FIdNumber.val('');
        FTransactionCode.val('');
        FOriginalAmount.val('');
        FFinalAmount.val('');
        FAccountNumber.val('');
        FIncomingIn.val('');
        fdateField.clear();
        FEmployeeName.val('').trigger('change');
        FStatus.val('').trigger('change');
        FCreatedBy.val('').trigger('change');
    }

    $('#approved').click(function() {
        let final_amount = $("#final_amount").val().trim();
        let correctness_remarks = $("#correctness_remarks").val().trim();
        let status = 4; 
            if (final_amount === "") {  
            $("#amount_error").text("Please enter Amount");
            $("#remarks_error").text("");
            $(".input-group").addClass("has-error");
            event.preventDefault();
            } else {
            $("#amount_error").text("");
            $("#remarks_error").text("");
            $(".input-group").removeClass("has-error");
            tev_details(final_amount,correctness_remarks,status,clicked_id);
            }
        });



    $('#employee-name').change(function() {
        var selectedOption = $(this).find('option:selected');
        var optionText = selectedOption.attr('id');
        if (optionText) {
            const employees = JSON.parse(localStorage.getItem('employees'));
            if (employees) {
                const selectedEmployeeId = selectedOption.attr('id');
                const selectedEmployee = employees.find(employee => employee.idNumber === selectedEmployeeId);
                if (selectedEmployee) {
                    $('#id-number').val(selectedEmployee.idNumber);
                    $('#acct-number').val(selectedEmployee.accNumber);
                    $('#emp-name').val(selectedEmployee.firstName);
                    $('#emp-middle').val(selectedEmployee.middleInitial);
                    $('#emp-lastname').val(selectedEmployee.lastName);
                    $('#division-user').val(selectedEmployee.division);
                    $('#section-user').val(selectedEmployee.section);
                    $('#contact-no').val(selectedEmployee.contact_no);
                }
            } else {
                console.log("No employee data found in local storage.");
            }
        }
    });

    $('#f-employee-name').change(function() {
        var selectedOptions = $(this).find('option:selected');
        selectedOptions.each(function() {
            var optionValue = $(this).val();
            if (employeeList.indexOf(optionValue) === -1) {
            employeeList.push(optionValue);
            }
        });
        $(this).find('option:not(:selected)').each(function() {
            var optionValue = $(this).val();
            var index = employeeList.indexOf(optionValue);
            if (index !== -1) {
            employeeList.splice(index, 1);
            }
        });

    });
        
    $('#returned').click(function() {
    let final_amount = $("#final_amount").val().trim();
    let correctness_remarks = $("#correctness_remarks").val().trim();
    let status = 3;
        if (correctness_remarks === "") {
        $("#amount_error").text("");
        $("#remarks_error").text("Please enter Remarks for returned.");
        $(".input-group").addClass("has-error");
        event.preventDefault();
        } else {
        $("#remarks_error").text("");
        $(".input-group").removeClass("has-error");
        tev_details(final_amount,correctness_remarks,status,clicked_id);
        }
        
    });

    function tev_details(amount,remarks,status,emp_id){
        $.ajax({
            type: "POST",
            url: "{% url 'add-tev-details' %}",
            data:{
                final_amount: amount,
                remarks: remarks,
                status : status,
                transaction_id : emp_id
            }
            }).done(function(data){
            if (data.data == 'success') {
                $('#tevDetails').modal('hide');
                toastr.success('Successfully save', 'Success', toast_options);
                offCanvasEl.hide()
                dataTable.ajax.reload()
            } else {
                toastr.danger('Data not saved', 'Danger', toast_options);
            }
        });
    }

    //select 2

    if (EmployeeName.length) {
        EmployeeName.wrap('<div class="position-relative"></div>')
        EmployeeName.select2({
            placeholder: 'Choose employee',
            dropdownParent: EmployeeName.parent(),
            allowClear: true,
        })
    }
    



    if (FStatus.length) {
        FStatus.wrap('<div class="position-relative"></div>')
        FStatus.select2({
            placeholder: 'Choose Status',
            dropdownParent: FStatus.parent(),
            allowClear: true,
        })
    }



    if (FCreatedBy.length) {
        FCreatedBy.wrap('<div class="position-relative"></div>')
        FCreatedBy.select2({
            placeholder: 'Choose Name',
            dropdownParent: FCreatedBy.parent(),
            allowClear: true,
        })
    }
        
        //end select2

    })

</script>

  

{% endblock footer_scripts %}
