{% load staticfiles %}
<!DOCTYPE html>

<html
    lang="en"
    class="light-style layout-navbar-fixed layout-menu-fixed"
    dir="ltr"
    data-theme="theme-default"
    data-assets-path="{% static 'assets/' %}"
    data-template="vertical-menu-template"
    
>	
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=0.6, user-scalable=yes, minimum-scale=0.6, maximum-scale=0.6" />

        <title>TRIPS</title>

        <meta name="description" content="" />

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="{% static 'assets/img/branding/logo.png' %}" />

        <!-- Fonts -->
        {% comment %}
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        {% endcomment %}
        <link rel="stylesheet" href="{% static 'fonts/main.css' %}" />

        <!-- Icons -->

        <link rel="stylesheet" href="{% static 'assets/vendor/fonts/fontawesome.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/fonts/tabler-icons.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/fonts/flag-icons.css' %}" />

        <!-- Core CSS -->

        <link rel="stylesheet" href="{% static 'assets/vendor/css/rtl/core.css' %}" class="template-customizer-core-css" />
        <link rel="stylesheet" href="{% static 'assets/vendor/css/rtl/theme-default.css' %}" class="template-customizer-theme-css" />
        <link rel="stylesheet" href="{% static 'assets/css/demo.css' %}" />

        <!-- Vendors CSS -->

        <link rel="stylesheet" href="{% static 'assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/node-waves/node-waves.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/typeahead-js/typeahead.css' %}" />
        <!-- <link rel="stylesheet" href="{% static 'assets/vendor/libs/dropzone/dropzone.css' %}" /> -->
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/apex-charts/apex-charts.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/swiper/swiper.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/node-waves/node-waves.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/select2/select2.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/animate-css/animate.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/sweetalert2/sweetalert2.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/toastr/toastr.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/bootstrap-select/bootstrap-select.css' %}" />

        <link rel="stylesheet" href="{% static 'assets/vendor/libs/flatpickr/flatpickr.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/jquery-timepicker/jquery-timepicker.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/pickr/pickr-themes.css' %}" />

        <link rel="stylesheet" href="{% static 'assets/vendor/libs/fullcalendar/fullcalendar.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/app-calendar.css' %}" />

        <link rel="stylesheet" href="{% static 'assets/vendor/libs/spinkit/spinkit.css' %}" />


        <!-- sales -->
        <link rel="stylesheet" href="{% static 'assets/vendor/libs/bs-stepper/bs-stepper.css' %}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/wizard-ex-checkout.css' %}" />
        
        <!-- Page CSS -->
        <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/cards-advance.css' %}" />
        <script src="{% static 'assets/vendor/js/helpers.js'%}"></script>


        <link rel="stylesheet" href="{% static 'assets/vendor/libs/bootstrap-maxlength/bootstrap-maxlength.css'%}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/page-profile.css'%}" />
        <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/app-chat.css'%}" /> 

 
        <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
        <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
        <script src="{% static 'assets/vendor/js/template-customizer.js'%}"></script>
        <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->

        <!-- Custom made CSS -->
       
            
        <script src="{% static 'assets/js/config.js'%}"></script>
        <link rel="stylesheet" href="{% static 'custom/custom.css'%}" />
    </head>

    <style>
        .chat-box {
        width: 300px;
        background-color: #f1f1f1;
        border-radius: 10px;
        position: fixed;
        bottom: 0px;
        right: 20px;
        z-index: 1000;

    }
    /* background-color: #46446b81; */

    .bg-body{
        background-color: transparent!important;
    }

    .chat-header {
        background-color: #685dd8;
        color: #fff;
        padding: 10px;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
        cursor: pointer;
    }

    .chat-body {
        display: none;
        flex: 1;
        padding: 10px;
        overflow-y: auto;
        max-height: 500px;
    }

    .chat-footer {
        display: none;
        padding: 10px;
        border-top: 1px solid #ccc;
    }

    .chat-footer input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    .message {
        max-height: 500px;
        overflow-y: auto;
    }

    .message .receive, .message .send {
        display: inline-block;
        max-width: 80%; /* Adjust this to fit your desired width */
        max-height: 40%;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 10px;
        word-wrap: break-word; /* Ensure long words wrap inside the message */
    }

    /* Styles for received messages */
    .message .receive {
        background-color: #e0e0e0; /* Gray background for received messages */
        text-align: left;
        float: left;
        clear: both;
        color: #000;
    }

    /* Styles for sent messages */
    .message .send {
        background-color: #0084ff; /* Blue background for sent messages */
        color: #fff;
        text-align: right;
        float: right;
        clear: both;
    }

    .message .receive p, .message .send p {
    margin: 0;
    line-height: 1.5; /* Adjust line height for better readability */
}

    </style>


    <body>
        <!-- Layout wrapper -->
        <div class="layout-wrapper layout-content-navbar">
            <div class="layout-container">
                <!-- Menu -->

                <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
                    <div class="app-brand demo">
                        <a href="#" class="app-brand-link">
                            <span class="app-brand-logo demo" style="width: 40px !important; height: 40px !important">
                                <img class="w-100" src="{% static 'assets/img/branding/logo.png' %}" />
                            </span>
                            <span class="app-brand-text demo menu-text fw-bold">TRIPS </span>
                        </a>

                        <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto">
                            <i class="ti menu-toggle-icon d-none d-xl-block ti-sm align-middle"></i>
                            <i class="ti ti-x d-block d-xl-none ti-sm align-middle"></i>
                        </a>
                    </div>

                    <div class="menu-inner-shadow"></div>
                    {% with request.resolver_match.url_name as url_name %}
                    <ul class="menu-inner py-1">
                        {% if permissions %}
                            {% if 'Admin' in permissions or 'Incoming staff' in permissions or 'Payroll staff' in permissions or 'Validating staff' in permissions or 'Certified staff' in permissions %}
                                <!-- Dashboard -->
                                <li class="menu-item {% if url_name == 'dashboard' %}active{% endif %}">
                                    <a href="{% url 'dashboard' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-smart-home"></i>
                                        <div data-i18n="Dashboard">Dashboard</div>
                                    </a>
                                </li>

                                <li class="menu-item {% if url_name == 'profile' or url_name == 'accomplishment' %}active  {% endif %}">
                                    <a href="{% url 'profile' %}" class="menu-link">
                                     
                                        <i class="menu-icon ti ti-user-check me-2 ti-sm"></i>
                                        <div data-i18n="My Profile">My Profile</div>
                                    </a>
                                </li>
                            {% endif %}
                        {% endif %}



                        {% if permissions %}
                        {% if 'Admin' in permissions or 'Incoming staff' in permissions or 'Payroll staff' in permissions or 'Validating staff' in permissions or 'Certified staff' in permissions or 'Outgoing staff' in permissions or 'Budget staff' in permissions or 'Journal staff' in permissions or 'Approval staff' in permissions %}
                            <!-- Inventory -->
                            <li class="menu-header small text-uppercase">
                                <span class="menu-header-text">Received Document</span>
                            </li>
                        {% endif %}

                       {% comment %} {% if 'Admin' in permissions  %} {% endcomment %}
                           
                        <li class="menu-item {% if url_name == 'travel-list' %}active{% endif %}">
                            <a href="{% url 'travel-list' %}" class="menu-link">
                                <i class="menu-icon tf-icons ti ti-components"></i>
                            
                                <div data-i18n="Travel">Travel</div>
                            </a>
                        </li>
                        
                        {% comment %} {% endif %} --> {% endcomment %}

                        {% if 'Admin' in permissions or 'Incoming staff' in permissions %}
                           
                            <li class="menu-item {% if url_name == 'receive-list' %}active{% endif %}">
                                <a href="{% url 'receive-list' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-checkbox"></i>
                                
                                    <div data-i18n="Received">Received</div>
                                </a>
                            </li>
                        {% endif %}
                    
                           
                        {% if 'Admin' in permissions or 'Validating staff' in permissions %}
                            <li class="menu-item {% if url_name == 'receive-checking' %}active{% endif %}">
                                <a href="{% url 'receive-checking' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-layout-sidebar"></i>
                                    <div data-i18n="Review of Documents">Review of Documents</div>
                                </a>
                            </li>
                        {% endif %}
                        {% if 'Admin' in permissions or 'Payroll staff' in permissions %}
                            <li class="menu-item {% if url_name == 'transaction-payroll' %}active{% endif %}" >
                                <a href="{% url 'transaction-payroll' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-brand-tabler"></i>
                                    
                                    <div data-i18n="Payroll List">Payroll List</div>
                                </a>
                            </li>
                            <li class="menu-item {% if url_name == 'box-a' %}active{% endif %}">
                                <a href="{% url 'box-a' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-layout-kanban"></i>
                                    <div data-i18n="Payroll Printing">Payroll Printing</div>
                                </a>
                            </li>
                        {% endif %}
                        {% if 'Admin' in permissions or 'Outgoing staff' in permissions %}
                            <li class="menu-item {% if url_name == 'outgoing-list' %}active{% endif %}">
                                <a href="{% url 'outgoing-list' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-forms"></i>
                                    <div data-i18n="Outgoing">Outgoing</div>
                                </a>
                            </li>
                        {% endif %}
                        {% if 'Admin' in permissions or 'Budget staff' in permissions %}
                            <li class="menu-item {% if url_name == 'budget-list' %}active{% endif %}">
                                <a href="{% url 'budget-list' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-text-wrap-disabled"></i>
                                    <div data-i18n="Budget">Budget</div>
                                </a>
                            </li>
                        {% endif %}
                        {% if 'Admin' in permissions or 'Journal staff' in permissions or 'Certified staff' in permissions %}
                            <li class="menu-item {% if url_name == 'journal-list' %}active{% endif %}">
                                <a href="{% url 'journal-list' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-layout-grid"></i>
                                    <div data-i18n="Journal">Journal</div>
                                </a>
                            </li>
                        {% endif %}
                        {% if 'Admin' in permissions or 'Approval staff' in permissions %}
                            <li class="menu-item {% if url_name == 'approval-list' %}active{% endif %}">
                                <a href="{% url 'approval-list' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-map"></i>
                                    <div data-i18n="Approval">Approval</div>
                                </a>
                            </li>
                            {% endif %}
                            
                        {% endif %}
                       
                        <!-- Tracking -->
                        <li class="menu-header small text-uppercase">
                            <span class="menu-header-text">Tracking</span>
                        </li>
                        
                        {% if 'Claimant' not in permissions %}
                        <li class="menu-item {% if url_name == 'status' %}active{% endif %}" >
                            <a href="{% url 'status' %}" class="menu-link">
                            
                                <i class="menu-icon tf-icons ti ti-lifebuoy"></i>
                                <div data-i18n="Status">Status</div>
                            </a>
                        </li>
                        {% endif %}

                        <li class="menu-item {% if url_name == 'travel-history' %}active{% endif %}">
                            <a href="{% url 'travel-history' %}" class="menu-link">
                                <i class="menu-icon tf-icons ti ti-brand-tabler"></i>
                                <div data-i18n="Travel History">Travel History</div>
                            </a>
                        </li>
                        {% if permissions %}
                            {% if 'Admin' in permissions or 'Incoming staff' in permissions or 'Payroll staff' in permissions or 'Validating staff' in permissions or 'Certified staff' in permissions %}
                                <li class="menu-item {% if url_name == 'travel-calendar' %}active{% endif %}">
                                    <a href="{% url 'travel-calendar' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-calendar"></i>
                                        <div data-i18n="Travel Calendar">Travel Calendar</div>
                                    </a>
                                </li>
                        {% endif %}
                            {% if 'Admin' in permissions or 'Incoming staff' in permissions or 'Payroll staff' in permissions or 'Validating staff' in permissions %}
                                <!-- Libraries -->
                                <li class="menu-header small text-uppercase">
                                    <span class="menu-header-text">Libraries</span>
                                </li>
                                <li class="menu-item {% if url_name == 'charges' %}active{% endif %}">
                                    <a href="{% url 'charges' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti fa-list-check"></i>
                                        <div data-i18n="Charges">Charges</div>
                                    </a>
                                </li>

                                <li class="menu-item {% if url_name == 'division' %}active{% endif %}">
                                    <a href="{% url 'division' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-file-description"></i>
                                        <div data-i18n="Offices">Offices</div>
                                    </a>
                                </li>

                                <li class="menu-item {% if url_name == 'remarks' %}active{% endif %}">
                                    <a href="{% url 'remarks' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-color-swatch"></i>
                                        <div data-i18n="Remarks">Remarks</div>
                                    </a>
                                </li>
                                <li class="menu-item {% if url_name == 'fare-matrix' %}active{% endif %}">
                                    <a href="{% url 'fare-matrix' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-chart-pie"></i>
                                        <div data-i18n="Fare Matrix">Fare Matrix</div>
                                    </a>
                                </li>
                            {% endif %}      
                        {% endif %}

                        {% if 'Admin' in permissions or 'Incoming staff' in permissions or 'Payroll staff' in permissions or 'Validating staff' in permissions %}
                            <li class="menu-header small text-uppercase">
                                <span class="menu-header-text">History</span>
                            </li>
                            <li class="menu-item {% if url_name == 'transaction-logs' %}active{% endif %}">
                                <a href="{% url 'transaction-logs' %}" class="menu-link">
                                    <i class="menu-icon tf-icons ti ti-lock"></i>
                                    <div data-i18n="Logs">Logs</div>
                                </a>
                            </li>

                
                        {% endif %}      
                
                        
                        {% if permissions %}
                            {% if 'Admin' in permissions %}
                                <!-- Admin -->
                                <li class="menu-header small text-uppercase">
                                    <span class="menu-header-text">Admin</span>
                                </li>

                                <li class="menu-item {% if url_name == 'users' %}active{% endif %}">
                                    <a href="{% url 'users' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-users"></i>
                                        <div data-i18n="Users">Users</div>
                                    </a>
                                </li>
                                <li class="menu-item {% if url_name == 'form_controls' %}active{% endif %}">
                                    <a href="{% url 'form_controls' %}" class="menu-link">
                                        
                                        <i class="menu-icon tf-icons ti ti-settings"></i>
                                        <div data-i18n="Form Controls">Form Controls</div>
                                    </a>
                                </li>

                                <li class="menu-item {% if url_name == 'chat' %}active{% endif %}">
                                    <a href="{% url 'chat' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-messages"></i>
                                        <div data-i18n="Chat">Chat</div>
                                    </a>
                                </li>
                                
                                <li class="menu-item {% if url_name == 'sms' %}active{% endif %}">
                                    <a href="{% url 'sms' %}" class="menu-link">
                                        <i class="menu-icon tf-icons ti ti-lock"></i>
                                        <div data-i18n="SMS">SMS</div>
                                    </a>
                                </li>

                            </ul>
                        {% endif %}
                    {% endif %}
                    {% endwith %}
                </aside>

                <!-- / Menu -->

                <!-- Layout container -->
                <div class="layout-page">
                    <!-- Navbar -->

                    <nav
                        class="layout-navbar container-fluid navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
                        id="layout-navbar"
                    >
                        <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
                            <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                                <i class="ti ti-menu-2 ti-sm"></i>
                            </a>
                        </div>

                        <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
                            <!-- Search -->
                            {% comment %} <div class="navbar-nav align-items-center">
                                <div class="nav-item navbar-search-wrapper mb-0">
                                    <a class="nav-item nav-link search-toggler d-flex align-items-center px-0" href="javascript:void(0);">
                                        <i class="ti ti-search ti-md me-2"></i>
                                        <span class="d-none d-md-inline-block text-muted">Search (Ctrl+/)</span>
                                    </a>
                                </div>
                            </div> {% endcomment %}
                            <!-- /Search -->

                            <ul class="navbar-nav flex-row align-items-center ms-auto">
                                <!-- Style Switcher -->
                                <li class="nav-item me-2 me-xl-0">
                                    <a class="nav-link style-switcher-toggle hide-arrow" href="javascript:void(0);">
                                        <i class="ti ti-md"></i>
                                    </a>
                                </li>
                                <!--/ Style Switcher -->

                                <li class="nav-item dropdown-notifications navbar-dropdown dropdown me-3 me-xl-1">
                                    <a
                                      class="nav-link hide-arrow"
                                      {% comment %} href="{% url 'chat-staff' %}" {% endcomment %}
                                      href="#"
                                    >
                                      <i class="ti ti-bell ti-md"></i>
                                      {% comment %} <span class="badge bg-danger rounded-pill badge-notifications">1</span> {% endcomment %}
                                    </a>
                                </li>
                                  <!--/ Notification -->

                                <!-- User -->
                                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                                    <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                                        <div class="avatar avatar-online">
                                            <img src="{% static 'assets/img/avatars/avatar_custom.png' %}" alt class="h-auto rounded-circle" />
                                        </div>
                                    </a>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li>
                                            <a class="dropdown-item" href="#">
                                                <div class="d-flex">
                                                    <div class="flex-shrink-0 me-3">
                                                        <div class="avatar avatar-online">
                                                            <img src="{% static 'assets/img/avatars/avatar_custom.png' %}" alt class="h-auto rounded-circle" />
                                                        </div>
                                                    </div>
                                                    <div class="flex-grow-1">
                                                        <span class="fw-semibold d-block">{{ request.user.first_name }} {{ request.user.last_name }}</span>
                                                        <small class="text-muted">{{ role_permission }}</small>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="dropdown-divider"></div>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" href="{% url 'profile' %}">
                                                <i class="ti ti-user-check me-2 ti-sm"></i>
                                                <span class="align-middle">My Profile</span>
                                            </a>
                                        </li>
                
                                        <li>
                                            <div class="dropdown-divider"></div>
                                        </li>
                                        <li>
                                     
                               
                                        <li>
                                            <a class="dropdown-item" href="{% url 'logout' %}">
                                                <i class="ti ti-logout me-2 ti-sm"></i>
                                                <span class="align-middle">Log Out</span>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <!--/ User -->
                            </ul>
                        </div>

                        <!-- Search Small Screens -->
                        <div class="navbar-search-wrapper search-input-wrapper d-none">
                            <input
                                type="text"
                                class="form-control search-input container-xxl border-0"
                                placeholder="Search..."
                                aria-label="Search..."
                            />
                            <i class="ti ti-x ti-sm search-toggler cursor-pointer"></i>
                        </div>
                    </nav>

                    <!-- / Navbar -->
                    <!-- Content wrapper -->
                    <div class="content-wrapper">
                        <!-- Content -->
                        {% if 'Admin' in permissions%}
                            <div class="chat-box">
                                <div class="chat-header" onclick="toggleChat()">
                                    Chat
                                </div>
                                <div class="chat-body">
                                </div>
                                <form id="create-room-form">
                                    {% csrf_token %}
                                    <div class="chat-footer">
                                        <label class="form-label" for="modalFEmployeeName">Staff Name</label>
                                        <select id="room" class="select2 form-select" name="room">
                                            <option></option>
                                            {% for row in users %}
                                            <option value="{{ row.id }}">{{ row.first_name }} {{ row.last_name }}</option>
                                            {% endfor %}
                                        </select>
                                        <br>

                                        <div class="message chat-history-body bg-body" id="chatContainer"></div>
            
                                        
                                        <!-- <div class="chat-history-body bg-body">
                                            <ul class="message list-unstyled chat-history" id="chatContainer">
                                            sasf
                                            </ul>
                                        </div> -->

                                    
                                        <div class="form">
                                            <form id="message-form">
                                                <!-- <textarea id="msg" cols="30" name="message" rows="10" placeholder="Enter your messages" required></textarea> -->
                                                <label class="form-label" for="modalFEmployeeName">Enter Message</label>
                                                <textarea
                                                class="form-control"
                                                id="msg"
                                                name="message"
                                                rows="3"
                                                required
                                            ></textarea>
                                            <br>
                                                <button class="btn btn-primary waves-effect waves-light" type="button" id="send-message">Send</button>
                                            </form>    
                                        </div>
                                    </div>
                                </form>
                            </div>
                        {% endif %}
                        {% block content %} {% csrf_token %} {% endblock %}
                        <!-- / Content -->
                    
                        <!-- Footer -->
                        <footer class="content-footer footer bg-footer-theme">
                            <div class="container-fluid">
                                <div class="footer-container d-flex align-items-center justify-content-between py-2 flex-md-row flex-column">
                                    <div>
                                        DEVELOPER : REYMARK N. VALDEHUEZA 
                                        © 2024
                                        <a href="#" class="fw-semibold">TRIPS</a> 
                                    </div>
                                    <div></div>
                                </div>
                            </div>
                        </footer>
                        <!-- / Footer -->

                        <div class="content-backdrop fade"></div>
                    </div>
                   
                    <!-- Content wrapper -->
                </div>
                <!-- / Layout page -->
            </div>

            <!-- Overlay -->
            <div class="layout-overlay layout-menu-toggle"></div>

            <!-- Drag Target Area To SlideIn Menu On Small Screens -->
            <div class="drag-target"></div>
        </div>
        <!-- / Layout wrapper -->

        <script>
            const BASE_URL = '{{ request.get_host }}'
        </script>

 

        <!-- Core JS -->
        <!-- build:js assets/vendor/js/core.js -->
        <script src="{% static 'assets/vendor/libs/jquery/jquery.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/popper/popper.js' %}"></script>
        <script src="{% static 'assets/vendor/js/bootstrap.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/node-waves/node-waves.js' %}"></script>

        <script src="{% static 'assets/vendor/libs/hammer/hammer.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/i18n/i18n.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/typeahead-js/typeahead.js' %}"></script>
        <script src="{% static 'assets/vendor/js/menu.js' %}"></script>
        <!-- endbuild -->


        <!-- Vendors JS -->
        <script src="{% static 'assets/vendor/libs/apex-charts/apexcharts.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/swiper/swiper.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/jquery-sticky/jquery-sticky.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/cleavejs/cleave.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/cleavejs/cleave-phone.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/select2/select2.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/moment/moment.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/flatpickr/flatpickr.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/typeahead-js/typeahead.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/tagify/tagify.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/sweetalert2/sweetalert2.js' %}"></script>
        <script src="{% static 'assets/js/extended-ui-sweetalert2.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/toastr/toastr.js' %}"></script>
        {% comment %} <script src="{% static 'assets/vendor/libs/bs-stepper/bs-stepper.js' %}"></script> {% endcomment %}
        <script src="{% static 'assets/vendor/libs/rateyo/rateyo.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/cleavejs/cleave.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/cleavejs/cleave-phone.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/bootstrap-select/bootstrap-select.js' %}"></script>

        <script src="{% static 'assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js' %}"></script>
        <script src="{% static 'assets/vendor/libs/jquery-timepicker/jquery-timepicker.js' %}"></script>
        

        <script src="{% static 'assets/vendor/libs/pickr/pickr.js' %}"></script>
        <!-- <script src="{% static 'assets/vendor/libs/dropzone/dropzone.js' %}"></script> -->


        <!-- Main JS -->
        <script src="{% static 'assets/js/main.js' %}"></script>

        <script src="{% static 'assets/js/ui-popover.js' %}"></script>

        <script src="{% static 'assets/js/ui-toasts.js' %}"></script>

        <script src="{% static 'assets/js/charts-apex.js' %}"></script>

        <script src="{% static 'assets/vendor/libs/apex-charts/apexcharts.js' %}"></script>

        <!-- Page JS -->
        <script src="{% static 'assets/js/dashboards-analytics.js' %}"></script>
        {% comment %} <script src="{% static 'assets/js/forms-pickers.js' %}"></script> {% endcomment %}
        <!-- <script src="{% static 'assets/js/forms-file-upload.js' %}"></script> -->

        <!-- Custom made JS -->
        <script src="{% static 'custom/custom.js' %}"></script>

        <!-- Vendors JS -->
        <script src="{% static 'assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js' %}"></script>
        <!-- Flat Picker -->
        <!-- Data tables -->
        <script src="{% static 'assets/js/tables-datatables-advanced.js' %}"></script>
        <script src="{% static 'assets/js/tables-datatables-extensions.js' %}"></script>
        <script src="{% static 'assets/js/tables-datatables-basic.js' %}"></script>

        <script src="{% static 'assets/vendor/libs/sweetalert2/sweetalert2.js' %}"></script>
        <script src="{% static 'assets/js/extended-ui-sweetalert2.js' %}"></script>

        {% comment %}
        <script src="{% static 'assets/js/modal-add-new-address.js' %}"></script>
        {% endcomment %}
        <script src="{% static 'assets/js/wizard-ex-checkout.js' %}"></script>

        <script src="{% static 'assets/vendor/libs/bootstrap-maxlength/bootstrap-maxlength.js' %}"></script>

        
        <script src="{% static 'assets/vendor/libs/fullcalendar/fullcalendar.js' %}"></script>
        <script src="{% static 'assets/js/app-calendar-events.js' %}"></script>
        <script src="{% static 'assets/js/dashboards-ecommerce.js' %}"></script>

        <script src="{% static 'assets/js/pages-profile.js' %}"></script>

        {% comment %} <script src="{% static 'assets/js/form-wizard-numbered.js' %}"></script>
        <script src="{% static 'assets/js/form-wizard-validation.js' %}"></script> {% endcomment %}

        {% comment %} <script src="{% static 'assets/js/app-chat.js' %}"></script>  {% endcomment %}
        <!-- <script src="../../assets/js/modal-add-new-address.js"></script>
        <script src="../../assets/js/wizard-ex-checkout.js"></script> -->

        <!-- <script src="{% static 'assets/js/tables-datatables-basic.js' %}"></script> -->


        <script>
        let socket = null;  // Declare socket outside to maintain the state

        $(document).ready(function(){
            // $('#room').change(function(){
            //     var roomName = $('select[name="room"]').val();
            //     console.log(roomName);
            //     $.ajax({
            //         url: "{% url 'create-room' %}",
            //         type: "POST",
            //         data: {
            //             'room': roomName
            //         },
            //         success: function(response) {
            //             if (socket) {
            //                 socket.close();
            //             }
            //             initializeChat(roomName, '{{ user }}');
            //         }
            //     });
            // });

            // $("#send-message").click(function(){
            //     const message = $('#msg').val();
            //     var roomName = $('select[name="room"]').val();
            //     console.log(roomName);
            //     console.log(message);
            //     console.log('{{ user }}');
            //     if (message && roomName) {
            //         sendMessage(message, roomName, '{{ user }}');
            //     }
            // });
        }); 

        // function initializeChat(roomName, username) {
        //     console.log("Initializing chat for room:", roomName);
        //     console.log(window.location.host);

        //     const websocketProtocol = window.location.protocol === "https:" ? "wss" : "ws";

        //     const wsEndpoint = `${websocketProtocol}://${window.location.host}/ws/notification/${roomName}/`;
        //     socket = new WebSocket(wsEndpoint);

        //     socket.addEventListener("open", () => {
        //         console.log("WebSocket connection opened for room:", roomName);
        //     });

        //     socket.addEventListener("message", (event) => { 
        //         const messageData = JSON.parse(event.data)['message'];
        //         var sender = messageData['sender'];
        //         var message = messageData['message'];

        //         var messageDiv = $('.message');
                
        //         if (sender != username) {
        //             messageDiv.append('<div class="receive"><p>' + message + '<strong> - ' + sender + '</strong></p></div>');
        //         } else {
        //             // Sent message, aligned right
        //             messageDiv.append('<div class="send"><p>' + message + '</p></div>');
        //         }
                
        //         scrollToBottom();
        //     });

        //     socket.addEventListener("error", (event) => {
        //         console.error("WebSocket error observed:", event);
        //     });

        //     socket.addEventListener("close", (event) => {
        //         console.log("WebSocket connection closed:", event);
        //     });
        // }

        // function sendMessage(message, roomName, username) {
        //     if (socket && socket.readyState === WebSocket.OPEN) {
        //         socket.send(
        //             JSON.stringify({
        //                 'message': message,
        //                 'room_name': roomName,
        //                 'sender': username,
        //             })
        //         );
        //         $('#msg').val('');  // Clear the message input field
        //     }
        //     else if (socket && socket.readyState === WebSocket.CONNECTING) {
        //         // Wait until the WebSocket connection is open
        //         socket.addEventListener('open', function(event) {
        //             socket.send(
        //                 JSON.stringify({
        //                     'message': message,
        //                     'room_name': roomName,
        //                     'sender': username,
        //                 })
        //             );
        //             $('#msg').val('');  // Clear the message input field
        //         });
        //     } 
        //     else {
        //         console.error("WebSocket is not open. Unable to send message.");
        //     }
        // }

        function scrollToBottom() {
            var chatContainer = document.getElementById("chatContainer");
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function toggleChat() {
            const ChatEmployee = jQuery(document.querySelector('[name="room"]'));
            const chatBody = document.querySelector('.chat-body');
            const chatFooter = document.querySelector('.chat-footer');
            const isHidden = chatBody.style.display === 'none';
            
            chatBody.style.display = isHidden ? 'flex' : 'none';
            chatFooter.style.display = isHidden ? 'block' : 'none';
            if (ChatEmployee.length) {
                ChatEmployee.wrap('<div class="position-relative"></div>')
                ChatEmployee.select2({
                    placeholder: 'Chat name',
                    dropdownParent: ChatEmployee.parent(),
                    allowClear: true,
                })
            }
        }
        

        </script>
        
        {% block footer_scripts %} {% endblock footer_scripts %}
    </body>
</html>