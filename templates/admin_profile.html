{% extends 'index.html' %} {% block content %} {% load staticfiles %}
<style>
  .bs-stepper-header {
    display: flex;
    flex-wrap: wrap; /* Allow items to wrap to the next line */
    justify-content: flex-start; /* Align items at the start of the row */
  }
  
  .step {
    flex: 0 0 calc(12.5% - 10px); /* Ensure each step takes up 12.5% of the width minus margin */
    min-width: 100px; /* Adjust the min-width to control the breakpoint at which the items wrap */
    margin-bottom: 10px; /* Add margin for spacing between rows */
    box-sizing: border-box; /* Ensure padding and border are included in the element's total width and height */
  }
  
  .line {
    flex: 0 0 30px; /* Ensure the line does not shrink and maintains a consistent width */
    align-self: center; /* Align the line vertically with the step items */
    margin: 0 5px; /* Add margin to ensure space between steps and lines */
  }
  
  .bs-stepper-circle,
  .bs-stepper-label {
    display: flex;
    align-items: center; /* Vertically center the items */
    justify-content: center; /* Horizontally center the items */
    text-align: center; /* Ensure text is centered */
  }


  
</style>
            <!-- Content -->
            <!-- <div class="container-fluid flex-grow-1 container-p-y"> -->
            <div class="container-fluid flex-grow-1 container-p-y">
              <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">User Profile /</span> Accomplishments</h4>

              <!-- Header -->
              <div class="row">
                <div class="col-12">
                  <div class="card mb-4">
                    <div class="user-profile-header-banner">
                      <img src="{% static 'assets/img/pages/profile-banner.png' %}" alt="Banner image" class="rounded-top" />
                    </div>
                    <div class="user-profile-header d-flex flex-column flex-sm-row text-sm-start text-center mb-4">
                      <div class="flex-shrink-0 mt-n2 mx-sm-0 mx-auto">
                        {% if image_path %}
                        <img
                          src="{{image_path}}"
                          alt="user image"
                          class="d-block h-auto ms-0 ms-sm-4 rounded user-profile-img"
                        />
                        {% else %}
                        <img
                        src="{% static 'assets/img/avatars/14.png' %}"
                          alt="user image"
                          class="d-block h-auto ms-0 ms-sm-4 rounded user-profile-img"
                        />
                        {% endif %}
                      </div>
                      <div class="flex-grow-1 mt-3 mt-sm-5">
                        <div
                          class="d-flex align-items-md-end align-items-sm-start align-items-center justify-content-md-between justify-content-start mx-4 flex-md-row flex-column gap-4"
                        >
                          <div class="user-profile-info">
                            <h4>{{ request.user.first_name }} {{ request.user.last_name }}</h4>
                            <ul
                              class="list-inline mb-0 d-flex align-items-center flex-wrap justify-content-sm-start justify-content-center gap-2"
                            >
                              <li class="list-inline-item"></i>{{position}}</li>
                            </ul>
                          </div>
                          <a href="javascript:void(0)" class="btn btn-success">
                            <i class="ti ti-user-check me-1"></i>Active
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Header -->

              <!--/ Navbar pills -->

              <!-- Navbar pills -->
              <div class="row">
                <div class="col-md-12">
                  <ul class="nav nav-pills flex-column flex-sm-row mb-4">
                    <li class="nav-item">
                      <a class="nav-link active"
                        ><i class="ti-xs ti ti-user-check me-1"></i> Profile</a
                      >
                    </li>
                   
                  </ul>
                </div>
              </div>
              <!--/ Navbar pills -->

              <!-- Alerts with Icons -->
              <div class="row">
                <div class="col-xl-4 col-lg-5 col-md-5">
                  <!-- About User -->
                  <div class="card mb-4">
                    <div class="card-body">
                      <small class="card-text text-uppercase">About</small>
                      <ul class="list-unstyled mb-4 mt-3">
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-user"></i><span class="fw-bold mx-2">Full Name:</span> <span>{{ request.user.first_name }} {{ request.user.last_name }}</span>
                        </li>
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-file-description"></i><span class="fw-bold mx-2">Id Number:</span>
                          <span>{{id_number}}</span>
                        </li>
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-crown"></i><span class="fw-bold mx-2">Position:</span> <span>{{position}}</span>
                        </li>
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-user"></i><span class="fw-bold mx-2">Sex:</span> <span>{{sex}}</span>
                        </li>
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-flag"></i><span class="fw-bold mx-2">Division:</span> <span>{{division_name}}</span>
                        </li>
                      </ul>
                      <small class="card-text text-uppercase">Contacts</small>
                      <ul class="list-unstyled mb-4 mt-3">
                        <li class="d-flex align-items-center mb-3">
                          <i class="ti ti-mail"></i><span class="fw-bold mx-2">Email:</span>
                          <span>{{ request.user.email }} </span>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              
                <div class="col-md">
                  <div class="card">
                    <h5 class="card-header">Accomplishments</h5>
                    
                    <div class="card-body">
                      <br>
                      <div class="alert alert-primary d-flex align-items-center" role="alert">
                        <span class="alert-icon text-primary me-2">
                          <i class="ti ti-info-circle ti-xs"></i>
                        </span>
                        Accomplishment report saving process has been significantly enhanced, ensuring faster and more efficient operations.
                      </div><br><br>
              
                      <div class="row">
                        <div class="col-5 col-md-5">
                          <label class="form-label" for="modalEditTaxID">Start Date</label>
                          <input type="date" class="form-control" name="FStartDate" id ="FStartDate" placeholder="DD-MM-YYYY" autocomplete="off" />
                        </div>
                        <div class="col-5 col-md-5">
                          <label class="form-label" for="modalEditTaxID">End Date</label>
                          <input type="date" class="form-control" name="FEndDate" id ="FEndDate" placeholder="DD-MM-YYYY" autocomplete="off" />
                        </div>
                        <div class="col-2 col-md-2">
                          <br>
                          <a href="javascript:void(0)" id="generate-accomplishment-admin" class="btn btn-primary" style="width:140px;">
                            Generate
                          </a>
                        </div>
                      </div>
                      <br>
                      <br>
                      <br>
                    </div>
                  </div>
                </div>
              </div>
            
     
              <div class="col-12 mb-4">
                
                <div class="bs-stepper wizard-numbered mt-2">
                  <div class="bs-stepper-header">
                    <div class="line"></div>
                    {% for user in staff %}
                    <div class="step" data-target="#account-details-{{ forloop.counter }}">
                      <button type="button" class="step-trigger">
                        <span class="bs-stepper-circle">{{ forloop.counter }}</span>
                        <span class="bs-stepper-label">
                          <span class="bs-stepper-title">{{ user.first_name }} {{ user.last_name }}</span>
                          <span class="bs-stepper-subtitle">Accomplishment</span>
                        </span>
                      </button>
                    </div>
                    <div class="line"></div>
                    {% endfor %}
              </div>

              <div class="bs-stepper-content">
                <form onSubmit="return false">
                  <!-- Account Details -->
                  {% for user in staff %}
                    <div id="account-details-{{ forloop.counter }}" class="content">
                      <div class="table-responsive text-nowrap">
                        <table class="table" id="accomplishment-tbl-{{ user.username }}">
                          <caption class="ms-4">
                            List of Accomplishment for {{ user.first_name }} {{ user.last_name }}
                          </caption>
                          <thead>
                            <tr>
                              <th>Date</th>
                              <th>Received</th>
                              <th>Reviewed</th>
                              <th>Payrolled</th>
                            </tr>
                          </thead>
                          <tbody>
                            <!-- Accomplishments data should be populated here -->
                          </tbody>
                        </table>
                      </div>
                    </div>
                  {% endfor %}
                </form>
              </div>





                    {% comment %} <div class="bs-stepper-content">
                      <form onSubmit="return false">
                        <!-- Account Details -->
                        <div id="account-details" class="content">
                          <div class="table-responsive text-nowrap">
                            <table class="table" id="accomplishment-tbl-sonny">
                              <caption class="ms-4">
                                List of Accomplishment
                              </caption>
                              <thead>
                                <tr>
                                  <th>Date</th>
                                  <th>Received</th>
                                  <th>Reviewed</th>
                                  <th>Payrolled</th>
                                </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                          </div>
                        </div>
                        <!-- Personal Info -->
                        <div id="personal-info" class="content">
                          <div class="table-responsive text-nowrap">
                            <table class="table" id="accomplishment-tbl-carl">
                              <caption class="ms-4">
                                List of Accomplishment
                              </caption>
                              <thead>
                                <tr>
                                  <th>Date</th>
                                  <th>Received</th>
                                  <th>Reviewed</th>
                                  <th>Payrolled</th>
                                </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                          </div>
                        </div>
                        <!-- Social Links -->
                        <div id="social-links" class="content">
                          <div class="table-responsive text-nowrap">
                            <table class="table" id="accomplishment-tbl-jhoannah">
                              <caption class="ms-4">
                                List of Accomplishment
                              </caption>
                              <thead>
                                <tr>
                                  <th>Date</th>
                                  <th>Received</th>
                                  <th>Reviewed</th>
                                  <th>Payrolled</th>
                                </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                          </div>
                        </div>
                        <!-- bernard Links -->
                        <div id="bernard" class="content">
                          <div class="table-responsive text-nowrap">
                            <table class="table" id="accomplishment-tbl-bernard">
                              <caption class="ms-4">
                                List of Accomplishment
                              </caption>
                              <thead>
                                <tr>
                                  <th>Date</th>
                                  <th>Received</th>
                                  <th>Reviewed</th>
                                  <th>Payrolled</th>
                                </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </form>
                    </div>
                     {% endcomment %}
                  </div>
                </div>
                <!-- /Default Wizard -->
              <br>
    
            </div>
            <!-- / Content -->

  {% endblock %}
  {% block footer_scripts %}
  <script>
    $(document).ready(function() {
      var steps = document.querySelectorAll('.step-trigger');
      const FStartDate = jQuery(document.querySelector('[name="FStartDate"]')),
            FEndDate = jQuery(document.querySelector('[name="FEndDate"]'));
      const toast_options = (toastr.options = {
        maxOpened: 1,
        autoDismiss: true,
        closeButton: true,
        newestOnTop: true,
        progressBar: true,
        positionClass: 'toast-top-right',
        rtl: isRtl,
      });

      steps.forEach(function(step) {
        step.addEventListener('click', function() {
          
          // Remove active state from all steps
          steps.forEach(function(s) {
            s.classList.remove('active');
          });
          
          // Add active state to the clicked step
          this.classList.add('active');
        });
      });



      $('#generate-accomplishment-admin').on('click', function() {
        var startDate = $('#start-date').val();
        var endDate = $('#end-date').val();

          $.ajax({
            type: 'POST',
            url: "{% url 'generate-accomplishment-admin' %}",
            data: {
              start_date: startDate,
              end_date: endDate,
              csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(data) {
              console.log(data);
              console.log("data");
            //   // Clear previous table data for each user
            //   $('table tbody').empty();

            //   // Iterate over the returned data
            //   data.forEach(function(userResult) {
            //     var tableId = `#accomplishment-tbl-${userResult.user.username}`;
                
            //     userResult.accomplishments.forEach(function(accomplishment) {
            //       var newRow = `<tr>
            //                       <td>${accomplishment.date}</td>
            //                       <td>${accomplishment.updated_count}</td>
            //                       <td>${accomplishment.reviewed_count}</td>
            //                       <td>${accomplishment.payrolled_count}</td>
            //                     </tr>`;
            //       $(tableId + ' tbody').append(newRow);
            //     });
            //   });
            // },
            // error: function(xhr, status, error) {
            //   // Handle errors
            //   console.error(xhr.responseText);
            }
          });
      });


      // $('#generate-accomplishment-admin').on('click', function() {
      //   $.ajax({
      //     type: 'POST',
      //     url: "{% url 'generate-accomplishment-admin' %}",
      //     data:{
      //       start_date: FStartDate.val(),
      //       end_date: FEndDate.val(),
      //     }
      //   }).done(function (data) {
      //     var tbody1 = $('#accomplishment-tbl-sonny tbody');
      //     var tbody2 = $('#accomplishment-tbl-carl tbody');
      //     var tbody3 = $('#accomplishment-tbl-jhoannah tbody');
      //     var tbody4 = $('#accomplishment-tbl-bernard tbody');
      //     tbody1.empty();
      //     tbody2.empty();
      //     tbody3.empty();
      //     tbody4.empty();
      //     $.each(data, function(index, item) {
      //       var row = $('<tr>').append(
      //           $('<td>').html('<span class="badge bg-label-primary">' + item.date + '</span>'),
      //           $('<td>').text(item.received_sonny),
      //           $('<td>').text(item.reviewed_sonny),
      //           $('<td>').text(item.payrolled_sonny)
      //       );
      //       tbody1.append(row);
      //     });
      //     $.each(data, function(index, item) {
      //       var row = $('<tr>').append(
      //           $('<td>').html('<span class="badge bg-label-primary">' + item.date + '</span>'),
      //           $('<td>').text(item.received_carl),
      //           $('<td>').text(item.reviewed_carl),
      //           $('<td>').text(item.payrolled_carl)
      //       );
      //       tbody2.append(row);
      //     });
      //     $.each(data, function(index, item) {
      //       var row = $('<tr>').append(
      //           $('<td>').html('<span class="badge bg-label-primary">' + item.date + '</span>'),
      //           $('<td>').text(item.received_jhoannah),
      //           $('<td>').text(item.reviewed_jhoannah),
      //           $('<td>').text(item.payrolled_jhoannah)
      //       );
      //       tbody3.append(row);
      //     });
      //     $.each(data, function(index, item) {
      //       var row = $('<tr>').append(
      //           $('<td>').html('<span class="badge bg-label-primary">' + item.date + '</span>'),
      //           $('<td>').text(item.received_bernard),
      //           $('<td>').text(item.reviewed_bernard),
      //           $('<td>').text(item.payrolled_bernard)
      //       );
      //       tbody4.append(row);
      //     });
      //     toastr.success('Generate Successfully', 'Success', toast_options);
      //   });
      // });

      
    });
  </script>
  {% endblock footer_scripts %}